# Synthetic Low-Light Data Generation
This repository contains a Python-based pipeline for generating realistic low-light training images from standard sRGB datasets (e.g., COCO). The core of this project is based on the principles from the "Unprocessing Images for Learned Raw Denoising" paper, allowing for the creation of synthetic raw data that is then used to simulate authentic low-light conditions, including sensor noise and ISP (Image Signal Processor) effects.

The data generated by this pipeline has been successfully used to train models that generalize well to real-world low-light datasets.

## Motivation

Deep learning models for tasks like object detection and action recognition in low-light environments suffer from a significant data scarcity problem. Manually collecting and annotating large-scale, low-light datasets is difficult and expensive.

This project aims to solve that problem by providing a robust pipeline to synthesize vast quantities of realistic, dark images with authentic noise profiles. The goal is to enable the training of high-performance models for challenging datasets like **Ex-Dark** and the **Extremely Low-Light condition Action Recognition (ELLAR) Dataset**.

## Key Features

* **sRGB-to-Raw Conversion:** Implements the `unprocess.py` pipeline to convert standard images into a synthetic raw Bayer format.
* **Realistic Noise Model:** Simulates authentic shot and read noise that is characteristic of real camera sensors.
* **ISP-Aware Synthesis:** Uses a forward processing pipeline (`process_new.py`) to convert the synthetic raw data back to linear RGB, allowing for realistic adjustments.
* **Advanced Low-Light Simulation:**
  * Uses a bilateral filter to separate illumination from detail, allowing for realistic darkening.
  * Applies contrast (S-curve) and saturation adjustments in linear space for more natural results.
* **Configurable Pipeline:** Key parameters (`ILLUMINATION_DARKEN_FACTOR`, `NOISE_LEVEL`, etc.) are easily tunable in the generation script.

## Results

A model trained on data generated by this pipeline achieved the following performance on the **Ex-Dark** dataset, demonstrating strong generalization to real-world low-light images:

* **Top-1 Accuracy: 74.33%**
* **Top-5 Accuracy: 96.29%**

## Project Structure
```
├── generate_low_light_new_coco.py  # Main script to run the full pipeline
├── unprocess.py                    # Core sRGB-to-Raw conversion logic
├── process_new.py                  # Core Raw-to-Linear-RGB processing logic
├── requirements.txt                # Project dependencies
└── README.md                       # This file
```
## Acknowledgements

This project utilizes code that is heavily based on the official repository for "Unprocessing Images for Learned Raw Denoising." We are grateful to the original authors for their contribution to the community.

* **Original Project:** [Link to the original repository](https://github.com/google-research/google-research/tree/master/unprocessing)
* **Original Paper:** > Brooks, T., Mildenhall, B., et al. (2019). 
    > **Unprocessing Images for Learned Raw Denoising**. 
    > *In IEEE Conference on Computer Vision and Pattern Recognition (CVPR).*

The original software is licensed under the Apache License, Version 2.0. A full copy of the license is available in the [LICENSE-Unprocessing](./LICENSE-Unprocessing) file in this repository.

---
*This project is not endorsed by or affiliated with the original authors.*
